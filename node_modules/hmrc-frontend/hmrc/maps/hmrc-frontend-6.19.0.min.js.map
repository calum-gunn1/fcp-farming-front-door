{"version":3,"sources":["src/utils/breakpoints.js","src/components/account-menu/account-menu.js","src/components/back-link-helper/back-link-helper.js","src/utils/debounce.js","src/components/timeout-dialog/utils.js","src/components/timeout-dialog/dialog.js","src/components/timeout-dialog/validate-input.js","src/components/timeout-dialog/redirectHelper.js","src/components/timeout-dialog/timeout-dialog.js","src/components/user-research-banner/user-research-banner.js","src/utils/cookies.js","src/components/timeout-dialog/session-activity-service.js","src/components/hmrc-print-link/hmrc-print-link.js","src/all.js","src/all-govuk-and-hmrc.js"],"names":["breakpoints","xs","mobile","tablet","desktop","getCurrentBreakpoint","windowWidth","Object","keys","reduce","acc","curr","window","innerWidth","isSmall","element","AccountMenu","$module","this","document","querySelector","$moduleBottomMargin","style","marginBottom","$mainNav","$showNavLinkMobile","$currentBreakpoint","BackLinkHelper","prototype","init","setup","addEventListener","eventHandlers","showNavLinkMobileClick","bind","func","wait","immediate","timeout","_this","_len","arguments","length","theParams","Array","_key","context","callNow","clearTimeout","setTimeout","apply","debounce","reinstantiate","resizeEvent","newBreakpoint","target","event","preventDefault","classList","contains","hideMainNavMobile","currentTarget","showMainNavMobile","add","setAttribute","removeAttribute","remove","referer","history","referrer","indexOf","location","host","replaceState","href","back","warn","console","utils","generateDomElementFromString","str","abc","createElement","innerHTML","firstChild","generateDomElementFromStringAndAppendText","text","$tmp","innerText","hasClass","selector","className","addClass","querySelectorAll","forEach","i","removeClass","removeElement","$elem","parent","parentNode","removeChild","ajaxGet","url","success","xhr","XMLHttpRequest","open","onreadystatechange","readyState","status","responseText","setRequestHeader","send","dialog","displayDialog","$elementToDisplay","$dialog","$overlay","$preparedElementToDisplay","resetElementsFunctionList","closeCallbacks","appendChild","push","body","handleTouch","elements","join","close","shift","fn","value","getAttribute","keepFocus","modalFocus","getElementById","stopPropagation","focus","elemToFocusOnReset","activeElement","removeEventListener","setupFocusHandlerAndFocusDialog","keydownListener","e","keyCode","setupKeydownHandler","touches","changedTouches","closeDialog","setAriaLabelledBy","addCloseHandler","closeHandler","ValidateInput","RedirectHelper","TimeoutDialog","$sessionActivityService","currentTimer","options","settings","cleanupFunctions","sessionActivityService","listenForSessionActivityAndResetDialogTimer","synchroniseTabs","onActivity","timeOfActivity","timestamp","cleanup","setupDialogTimer","validateInput","config","missingRequiredConfig","item","concat","replace","toLowerCase","Error","mergeOptionsWithDefaults","theOptions","localisedDefaults","clone","_objectSpread","key","_typeof","undefined","timeOfLastActivity","getDateNow","signoutTime","delta","secondsUntilTimeoutDialog","countdown","setupDialog","$element","title","$countdownElement","$audibleMessage","$visualMessge","message","createTextNode","messageSuffix","$wrapper","$staySignedInButton","keepAliveButtonText","keepAliveAndClose","hideSignOutButton","$signOutButton","signOutButtonText","signOut","signOutUrl","dialogControl","getMillisecondsRemaining","getHumanText","counter","minutes","visibleMessage","properties","Math","ceil","roundSecondsUp","updateTextIfChanged","updateCountdown","audibleHumanText","humanText","messageParts","getAudibleHumanText","runUpdate","remaining","roundedRemaining","max","round","floor","keepAliveUrl","logActivity","Date","now","redirectToUrl","timeoutUrl","validate","lookupData","attributes","getNamedItem","string","minute","seconds","second","stringToValidate","parsedInt","parseInt","Number","isNaN","String","redirectHelper","UserResearchBanner","$closeLink","cookieName","cookieExpiryDays","name","nameEQ","cookies","cookie","split","len","charAt","substring","decodeURIComponent","getCookie","noThanksClick","cookieString","days","date","setTime","getTime","toGMTString","protocol","setCookie","SessionActivityService","BrowserBroadcastChannel","_classCallCheck","activityChannel","postMessage","callback","onmessage","data","HmrcPrintLink","print","HMRCFrontend","initAll","$AccountMenuSelector","$HmrcPrintLink","BroadcastChannel","$TimeoutDialog","$UserResearchBanner","$BackLink"],"mappings":"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","file":"../hmrc-frontend-6.19.0.min.js","sourcesContent":["// TODO\n// Retrieve breakpoints from Sass vars?\nexport const breakpoints = {\n  xs: 0,\n  mobile: 320,\n  tablet: 641,\n  desktop: 769,\n};\n\nexport function getCurrentBreakpoint(windowWidth) {\n  const reducer = (acc, curr) => {\n    const windowInsideBreakpoint = (windowWidth || window.innerWidth) >= breakpoints[curr];\n    return windowInsideBreakpoint ? curr : acc;\n  };\n  return Object.keys(breakpoints).reduce(reducer);\n}\n","import { debounce } from '../../utils/debounce';\nimport { getCurrentBreakpoint } from '../../utils/breakpoints';\n\nconst isSmall = (element) => element.innerWidth <= 768;\n\nfunction AccountMenu($module) {\n  this.$module = document.querySelector($module);\n  this.$moduleBottomMargin = this.$module.style.marginBottom;\n  this.$mainNav = this.$module.querySelector('.hmrc-account-menu__main');\n  this.$showNavLinkMobile = this.$module.querySelector('.hmrc-account-menu__link--menu');\n  this.$currentBreakpoint = getCurrentBreakpoint();\n}\n\nAccountMenu.prototype.init = function init() {\n  this.setup();\n\n  this.$showNavLinkMobile.addEventListener('click', this.eventHandlers.showNavLinkMobileClick.bind(this));\n\n  window.addEventListener('resize', debounce(this.reinstantiate.bind(this)));\n};\n\nAccountMenu.prototype.reinstantiate = function reinstantiate(resizeEvent) {\n  const newBreakpoint = getCurrentBreakpoint(resizeEvent.target.innerWidth);\n  const hasCrossedBreakpoint = this.$currentBreakpoint !== newBreakpoint;\n  if (hasCrossedBreakpoint) {\n    this.$currentBreakpoint = newBreakpoint;\n    this.setup();\n  }\n};\n\nAccountMenu.prototype.eventHandlers = {\n  showNavLinkMobileClick(event) {\n    event.preventDefault();\n\n    if (isSmall(window)) {\n      if (this.$mainNav.classList.contains('main-nav-is-open')) {\n        this.hideMainNavMobile(event.currentTarget);\n      } else {\n        this.showMainNavMobile();\n      }\n    }\n  },\n};\n\nAccountMenu.prototype.setup = function setup() {\n  if (isSmall(window)) {\n    this.$module.classList.add('is-smaller');\n    this.$showNavLinkMobile.setAttribute('aria-hidden', 'false');\n    this.$showNavLinkMobile.removeAttribute('tabindex');\n    this.$showNavLinkMobile.classList.remove('js-hidden');\n\n    this.hideMainNavMobile(this.$showNavLinkMobile);\n  } else {\n    this.$module.classList.remove('is-smaller');\n    this.$mainNav.classList.remove('main-nav-is-open', 'js-hidden');\n    this.$showNavLinkMobile.setAttribute('aria-hidden', 'true');\n    this.$showNavLinkMobile.setAttribute('tabindex', '-1');\n    this.$showNavLinkMobile.classList.add('js-hidden');\n  }\n};\n\nAccountMenu.prototype.showMainNavMobile = function showMainNavMobile() {\n  // TODO: shall we add main-nav-is-open to `nav`????\n  this.$mainNav.classList.remove('js-hidden');\n  this.$mainNav.classList.add('main-nav-is-open');\n  this.$mainNav.setAttribute('aria-expanded', 'true');\n\n  this.$showNavLinkMobile.setAttribute('aria-expanded', 'true');\n  this.$showNavLinkMobile.classList.add('hmrc-account-home--account--is-open');\n};\n\nAccountMenu.prototype.hideMainNavMobile = function hideMainNavMobile(element) {\n  this.$mainNav.classList.remove('main-nav-is-open');\n  this.$mainNav.setAttribute('aria-expanded', 'false');\n\n  if (element.classList.contains('hmrc-account-menu__link--menu')) {\n    this.$mainNav.classList.add('js-hidden');\n\n    this.$showNavLinkMobile.setAttribute('aria-expanded', 'false');\n    this.$showNavLinkMobile.classList.remove('hmrc-account-home--account--is-open');\n  }\n};\n\nexport default AccountMenu;\n","function BackLinkHelper($module, window, document) {\n  this.$module = $module;\n  this.window = window;\n  this.document = document;\n}\n\nBackLinkHelper.prototype.init = function init() {\n  // do nothing if History API is absent\n  if (this.window.history) {\n    // eslint-disable-next-line max-len\n    /* TODO: It remains unclear whether a check for the same domain is necessary for security reasons.\n       There may be user research suggesting considerations regarding the visibility of the\n       back link on refresh.\n       Currently, a page refresh sets the referer to empty, leading to the back link being hidden\n       under our existing logic.\n     */\n    // eslint-disable-next-line max-len\n    const referrerNotOnSameDomain = () => {\n      const referer = this.document.referrer;\n      return !referer || referer.indexOf(this.window.location.host) === -1;\n    };\n\n    // hide the backlink if the referrer is on a different domain or the referrer is not set\n    if (referrerNotOnSameDomain()) {\n      this.$module.classList.add('hmrc-hidden-backlink');\n    } else {\n      // prevent resubmit warning\n      if (this.window.history.replaceState && typeof this.window.history.replaceState === 'function') {\n        this.window.history.replaceState(null, null, this.window.location.href);\n      }\n\n      this.$module.addEventListener('click', (event) => {\n        event.preventDefault();\n        if (this.window.history.back && typeof this.window.history.back === 'function') {\n          this.window.history.back();\n        }\n      });\n    }\n  }\n};\n\nexport default BackLinkHelper;\n","// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n\n// eslint-disable-next-line  import/prefer-default-export\nexport function debounce(func, wait, immediate) {\n  let timeout;\n\n  return (...theParams) => {\n    const context = this;\n\n    const later = () => {\n      timeout = null;\n      if (!immediate) func.apply(context, theParams);\n    };\n\n    const callNow = immediate && !timeout;\n\n    clearTimeout(timeout);\n\n    timeout = setTimeout(later, wait);\n\n    if (callNow) func.apply(context, theParams);\n  };\n}\n","const { warn } = console;\n\nconst utils = {\n  generateDomElementFromString(str) {\n    const abc = document.createElement('div');\n    abc.innerHTML = str;\n    return abc.firstChild;\n  },\n\n  generateDomElementFromStringAndAppendText(str, text) {\n    const $tmp = utils.generateDomElementFromString(str);\n    $tmp.innerText = text;\n    return $tmp;\n  },\n\n  hasClass(selector, className) {\n    return document.querySelector(selector).classList.contains(className);\n  },\n\n  addClass(selector, className) {\n    const elements = document.querySelectorAll(selector);\n    elements.forEach((i) => { i.classList.add(className); });\n  },\n\n  removeClass(selector, className) {\n    const elements = document.querySelectorAll(selector);\n    elements.forEach((i) => { i.classList.remove(className); });\n  },\n\n  removeElement($elem) {\n    const parent = $elem.parentNode;\n    if (parent) {\n      parent.removeChild($elem);\n    } else {\n      warn(\"couldn't find parent for elem\", $elem);\n    }\n  },\n\n  ajaxGet(url, success) {\n    const xhr = new XMLHttpRequest();\n    xhr.open('GET', url);\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState > 3 && xhr.status === 200) success(xhr.responseText);\n    };\n    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n    xhr.send();\n    return xhr;\n  },\n};\n\nexport default utils;\n","import utils from './utils';\n\nfunction displayDialog($elementToDisplay) {\n  const $dialog = utils.generateDomElementFromString('<div id=\"hmrc-timeout-dialog\" tabindex=\"-1\" role=\"dialog\" aria-modal=\"true\" class=\"hmrc-timeout-dialog\">');\n  const $overlay = utils.generateDomElementFromString('<div id=\"hmrc-timeout-overlay\" class=\"hmrc-timeout-overlay\">');\n  const $preparedElementToDisplay = typeof $elementToDisplay === 'string' ? utils.generateDomElementFromString($elementToDisplay) : $elementToDisplay;\n  const resetElementsFunctionList = [];\n  const closeCallbacks = [];\n\n  $dialog.appendChild($preparedElementToDisplay);\n\n  if (!utils.hasClass('html', 'noScroll')) {\n    utils.addClass('html', 'noScroll');\n    resetElementsFunctionList.push(() => {\n      utils.removeClass('html', 'noScroll');\n    });\n  }\n  document.body.appendChild($dialog);\n  document.body.appendChild($overlay);\n\n  resetElementsFunctionList.push(() => {\n    utils.removeElement($dialog);\n    utils.removeElement($overlay);\n  });\n\n  const setupFocusHandlerAndFocusDialog = () => {\n    function keepFocus(event) {\n      const modalFocus = document.getElementById('hmrc-timeout-dialog');\n      if (modalFocus) {\n        if (event.target !== modalFocus && !modalFocus.contains(event.target)) {\n          event.stopPropagation();\n          modalFocus.focus();\n        }\n      }\n    }\n\n    const elemToFocusOnReset = document.activeElement;\n    $dialog.focus();\n\n    document.addEventListener('focus', keepFocus, true);\n\n    resetElementsFunctionList.push(() => {\n      document.removeEventListener('focus', keepFocus);\n      elemToFocusOnReset.focus();\n    });\n  };\n\n  // disable the non-dialog page to prevent confusion for VoiceOver users\n  const selectors = [\n    '#skiplink-container',\n    'body > header',\n    '#global-cookie-message',\n    'main',\n    'body > footer',\n    'body > .govuk-skip-link',\n    '.cbanner-govuk-cookie-banner',\n    'body > .govuk-width-container',\n  ];\n  const elements = document.querySelectorAll(selectors.join(', '));\n  const close = () => {\n    while (resetElementsFunctionList.length > 0) {\n      const fn = resetElementsFunctionList.shift();\n      fn();\n    }\n  };\n  const closeAndInform = () => {\n    closeCallbacks.forEach((fn) => { fn(); });\n    close();\n  };\n  const setupKeydownHandler = () => {\n    function keydownListener(e) {\n      if (e.keyCode === 27) {\n        closeAndInform();\n      }\n    }\n\n    document.addEventListener('keydown', keydownListener);\n\n    resetElementsFunctionList.push(() => {\n      document.removeEventListener('keydown', keydownListener);\n    });\n  };\n  const preventMobileScrollWhileAllowingPinchZoom = () => {\n    const handleTouch = (e) => {\n      const touches = e.touches || e.changedTouches || [];\n\n      if (touches.length === 1) {\n        e.preventDefault();\n      }\n    };\n\n    document.addEventListener('touchmove', handleTouch, true);\n\n    resetElementsFunctionList.push(() => {\n      document.removeEventListener('touchmove', handleTouch, true);\n    });\n  };\n\n  elements.forEach(($elem) => {\n    const value = $elem.getAttribute('aria-hidden');\n    $elem.setAttribute('aria-hidden', 'true');\n    resetElementsFunctionList.push(() => {\n      if (value) {\n        $elem.setAttribute('aria-hidden', value);\n      } else {\n        $elem.removeAttribute('aria-hidden');\n      }\n    });\n  });\n\n  //\n  setupFocusHandlerAndFocusDialog();\n\n  setupKeydownHandler();\n\n  preventMobileScrollWhileAllowingPinchZoom();\n\n  return {\n    closeDialog() {\n      close();\n    },\n    setAriaLabelledBy(value) {\n      if (value) {\n        $dialog.setAttribute('aria-labelledby', value);\n      } else {\n        $dialog.removeAttribute('aria-labelledby');\n      }\n    },\n    addCloseHandler(closeHandler) {\n      closeCallbacks.push(closeHandler);\n    },\n  };\n}\n\nexport default { displayDialog };\n","function ValidateInput() {\n}\n\nValidateInput.int = (stringToValidate) => {\n  const parsedInt = parseInt(stringToValidate, 10);\n  return Number.isNaN(parsedInt) ? undefined : parsedInt;\n};\n\nValidateInput.string = (stringToValidate) => (typeof stringToValidate === 'string' ? stringToValidate : undefined);\n\nValidateInput.boolean = (stringToValidate) => String(stringToValidate).toLowerCase() === 'true';\n\nexport default ValidateInput;\n","function RedirectHelper() {}\n\nRedirectHelper.redirectToUrl = (url) => {\n  // This exists to make redirects more testable\n  window.location.href = url;\n};\n\nexport default RedirectHelper;\n","import dialog from './dialog';\nimport ValidateInput from './validate-input';\nimport RedirectHelper from './redirectHelper';\nimport utils from './utils';\n\n// TODO: rewrite this to follow govuk-frontend prototype module pattern\n\nfunction TimeoutDialog($module, $sessionActivityService) {\n  let options = {};\n  let settings = {};\n  const cleanupFunctions = [];\n  let currentTimer;\n  const sessionActivityService = $sessionActivityService;\n\n  function init() {\n    const validate = ValidateInput;\n\n    function lookupData(key) {\n      return ($module.attributes.getNamedItem(key) || {}).value;\n    }\n\n    const localisedDefaults = validate.string(lookupData('data-language')) === 'cy' ? {\n      title: 'Rydych ar fin cael eich allgofnodi',\n      message: 'Er eich diogelwch, byddwn yn eich allgofnodi cyn pen',\n      keepAliveButtonText: 'Parhau i fod wedi’ch mewngofnodi',\n      signOutButtonText: 'Allgofnodi',\n      properties: {\n        minutes: 'funud',\n        minute: 'funud',\n        seconds: 'eiliad',\n        second: 'eiliad',\n      },\n    } : {\n      title: 'You’re about to be signed out',\n      message: 'For your security, we will sign you out in',\n      keepAliveButtonText: 'Stay signed in',\n      signOutButtonText: 'Sign out',\n      properties: {\n        minutes: 'minutes',\n        minute: 'minute',\n        seconds: 'seconds',\n        second: 'second',\n      },\n    };\n\n    options = {\n      timeout: validate.int(lookupData('data-timeout')),\n      countdown: validate.int(lookupData('data-countdown')),\n      keepAliveUrl: validate.string(lookupData('data-keep-alive-url')),\n      signOutUrl: validate.string(lookupData('data-sign-out-url')),\n      timeoutUrl: validate.string(lookupData('data-timeout-url')),\n      title: validate.string(lookupData('data-title')),\n      message: validate.string(lookupData('data-message')),\n      messageSuffix: validate.string(lookupData('data-message-suffix')),\n      keepAliveButtonText: validate.string(\n        lookupData('data-keep-alive-button-text'),\n      ),\n      signOutButtonText: validate.string(\n        lookupData('data-sign-out-button-text'),\n      ),\n      synchroniseTabs: validate.boolean(\n        lookupData('data-synchronise-tabs') || false,\n      ),\n      hideSignOutButton: validate.boolean(\n        lookupData('data-hide-sign-out-button') || false,\n      ),\n    };\n\n    // Default timeoutUrl to signOutUrl if not set\n    options.timeoutUrl = options.timeoutUrl || options.signOutUrl;\n\n    validateInput(options);\n    settings = mergeOptionsWithDefaults(options, localisedDefaults);\n    setupDialogTimer();\n    listenForSessionActivityAndResetDialogTimer();\n  }\n\n  const broadcastSessionActivity = () => {\n    sessionActivityService.logActivity();\n  };\n\n  const listenForSessionActivityAndResetDialogTimer = () => {\n    if (settings.synchroniseTabs) {\n      sessionActivityService.onActivity((event) => {\n        const timeOfActivity = event.timestamp;\n        cleanup();\n        setupDialogTimer(timeOfActivity);\n      });\n    }\n  };\n\n  const validateInput = (config) => {\n    const requiredConfig = ['timeout', 'countdown', 'keepAliveUrl', 'signOutUrl'];\n    const missingRequiredConfig = [];\n\n    requiredConfig.forEach((item) => {\n      if (!config[item]) {\n        missingRequiredConfig.push(`data-${item.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase()}`);\n      }\n    });\n\n    if (missingRequiredConfig.length > 0) {\n      throw new Error(\n        `Missing config item(s): [${missingRequiredConfig.join(', ')}]`,\n      );\n    }\n  };\n\n  const mergeOptionsWithDefaults = (theOptions, localisedDefaults) => {\n    const clone = { ...theOptions };\n\n    Object.keys(localisedDefaults).forEach((key) => {\n      if (typeof clone[key] === 'object') {\n        clone[key] = mergeOptionsWithDefaults(\n          theOptions[key],\n          localisedDefaults[key],\n        );\n      }\n      if (clone[key] === undefined || clone[key] === '') {\n        clone[key] = localisedDefaults[key];\n      }\n    });\n\n    return clone;\n  };\n\n  const setupDialogTimer = (timeOfLastActivity = getDateNow()) => {\n    const signoutTime = timeOfLastActivity + settings.timeout * 1000;\n\n    const delta = getDateNow() - timeOfLastActivity;\n    const secondsUntilTimeoutDialog = settings.timeout - settings.countdown;\n    const timeout = window.setTimeout(() => {\n      setupDialog(signoutTime);\n    }, (secondsUntilTimeoutDialog * 1000) - delta);\n\n    cleanupFunctions.push(() => {\n      window.clearTimeout(timeout);\n      if (currentTimer) {\n        window.clearTimeout(currentTimer);\n      }\n    });\n  };\n\n  const wrapLink = ($elem) => {\n    const $wrapper = document.createElement('div');\n    $wrapper.classList.add('hmrc-timeout-dialog__link-wrapper');\n    $wrapper.appendChild($elem);\n\n    return $wrapper;\n  };\n\n  const setupDialog = (signoutTime) => {\n    const $element = utils.generateDomElementFromString('<div>');\n\n    if (settings.title) {\n      const $tmp = utils.generateDomElementFromStringAndAppendText(\n        '<h1 id=\"hmrc-timeout-heading\" class=\"govuk-heading-m push--top\">',\n        settings.title,\n      );\n      $element.appendChild($tmp);\n    }\n\n    const $countdownElement = utils.generateDomElementFromString(\n      '<span id=\"hmrc-timeout-countdown\" class=\"hmrc-timeout-dialog__countdown\">',\n    );\n\n    const $audibleMessage = utils.generateDomElementFromString('<p id=\"hmrc-timeout-message\" class=\"govuk-visually-hidden screenreader-content\" aria-live=\"assertive\">');\n    const $visualMessge = utils.generateDomElementFromStringAndAppendText(\n      '<p class=\"govuk-body hmrc-timeout-dialog__message\" aria-hidden=\"true\">',\n      settings.message,\n    );\n    $visualMessge.appendChild(document.createTextNode(' '));\n    $visualMessge.appendChild($countdownElement);\n    $visualMessge.appendChild(document.createTextNode('.'));\n    if (settings.messageSuffix) {\n      $visualMessge.appendChild(document.createTextNode(` ${settings.messageSuffix}`));\n    }\n\n    const $staySignedInButton = utils.generateDomElementFromStringAndAppendText(\n      '<button id=\"hmrc-timeout-keep-signin-btn\" class=\"govuk-button\">',\n      settings.keepAliveButtonText,\n    );\n\n    $element.appendChild($visualMessge);\n    $element.appendChild($audibleMessage);\n    $element.appendChild($staySignedInButton);\n    $staySignedInButton.addEventListener('click', keepAliveAndClose);\n    $element.appendChild(document.createTextNode(' '));\n\n    if (!settings.hideSignOutButton) {\n      const $signOutButton = utils.generateDomElementFromStringAndAppendText(\n        '<a id=\"hmrc-timeout-sign-out-link\" class=\"govuk-link hmrc-timeout-dialog__link\">',\n        settings.signOutButtonText,\n      );\n      $signOutButton.addEventListener('click', signOut);\n      $signOutButton.setAttribute('href', settings.signOutUrl);\n\n      $element.appendChild(wrapLink($signOutButton));\n    }\n\n    const dialogControl = dialog.displayDialog($element);\n\n    cleanupFunctions.push(() => {\n      dialogControl.closeDialog();\n    });\n\n    dialogControl.addCloseHandler(keepAliveAndClose);\n\n    dialogControl.setAriaLabelledBy('hmrc-timeout-heading hmrc-timeout-message');\n\n    const getMillisecondsRemaining = () => signoutTime - getDateNow();\n    const getSecondsRemaining = () => Math.round(getMillisecondsRemaining() / 1000);\n\n    const getHumanText = (counter) => {\n      let minutes; let\n        visibleMessage;\n      if (counter < 60) {\n        visibleMessage = `${counter} ${settings.properties[counter !== 1 ? 'seconds' : 'second']}`;\n      } else {\n        minutes = Math.ceil(counter / 60);\n        visibleMessage = `${minutes} ${settings.properties[minutes === 1 ? 'minute' : 'minutes']}`;\n      }\n      return visibleMessage;\n    };\n\n    const getAudibleHumanText = (counter) => {\n      const humanText = getHumanText(roundSecondsUp(counter));\n      const messageParts = [settings.message, ' ', humanText, '.'];\n      if (settings.messageSuffix) {\n        messageParts.push(' ');\n        messageParts.push(settings.messageSuffix);\n      }\n      return messageParts.join('');\n    };\n\n    const roundSecondsUp = (counter) => {\n      if (counter > 60) {\n        return counter;\n      } if (counter < 20) {\n        return 20;\n      }\n      return Math.ceil(counter / 20) * 20;\n    };\n\n    const updateTextIfChanged = ($elem, text) => {\n      if ($elem.innerText !== text) {\n        // eslint-disable-next-line no-param-reassign\n        $elem.innerText = text;\n      }\n    };\n\n    const updateCountdown = (counter) => {\n      const visibleMessage = getHumanText(counter);\n      const audibleHumanText = getAudibleHumanText(counter);\n\n      updateTextIfChanged($countdownElement, visibleMessage);\n      updateTextIfChanged($audibleMessage, audibleHumanText);\n    };\n\n    const getNextTimeout = () => {\n      const remaining = getMillisecondsRemaining();\n      const roundedRemaining = Math.floor(getMillisecondsRemaining() / 1000) * 1000;\n      if (roundedRemaining <= 60000) {\n        return (remaining - roundedRemaining) || 1000;\n      }\n      return remaining - (roundedRemaining - (roundedRemaining % 60000 || 60000));\n    };\n\n    const runUpdate = () => {\n      const counter = Math.max(getSecondsRemaining(), 0);\n      updateCountdown(counter);\n      if (counter === 0) {\n        timeout();\n      } else {\n        currentTimer = window.setTimeout(runUpdate, getNextTimeout());\n      }\n    };\n\n    runUpdate();\n  };\n\n  const keepAliveAndClose = () => {\n    cleanup();\n    setupDialogTimer();\n    utils.ajaxGet(settings.keepAliveUrl, () => {});\n    broadcastSessionActivity();\n  };\n\n  const getDateNow = () => Date.now();\n\n  const signOut = () => {\n    RedirectHelper.redirectToUrl(settings.signOutUrl);\n  };\n\n  const timeout = () => {\n    RedirectHelper.redirectToUrl(settings.timeoutUrl);\n  };\n\n  const cleanup = () => {\n    while (cleanupFunctions.length > 0) {\n      const fn = cleanupFunctions.shift();\n      fn();\n    }\n  };\n\n  return { init, cleanup };\n}\n\nTimeoutDialog.dialog = dialog;\nTimeoutDialog.redirectHelper = RedirectHelper;\nTimeoutDialog.utils = utils;\n\nexport default TimeoutDialog;\n","import { getCookie, setCookie } from '../../utils/cookies';\n\nfunction UserResearchBanner($module) {\n  this.$module = $module;\n  this.$closeLink = this.$module.querySelector('.hmrc-user-research-banner__close');\n  this.cookieName = 'mdtpurr';\n  this.cookieExpiryDays = 28;\n}\n\nUserResearchBanner.prototype.init = function init() {\n  const cookieData = getCookie(this.cookieName);\n\n  if (cookieData == null) {\n    this.$module.classList.add('hmrc-user-research-banner--show');\n    this.$closeLink.addEventListener('click', this.eventHandlers.noThanksClick.bind(this));\n  }\n};\n\nUserResearchBanner.prototype.eventHandlers = {\n  noThanksClick(event) {\n    event.preventDefault();\n\n    setCookie(this.cookieName, 'suppress_for_all_services', { days: this.cookieExpiryDays });\n    this.$module.classList.remove('hmrc-user-research-banner--show');\n  },\n};\n\nexport default UserResearchBanner;\n","// Based on https://github.com/alphagov/govuk_template_jinja\nexport const setCookie = (name, value, options = {}) => {\n  let cookieString = `${name}=${value}; path=/`;\n  if (options.days) {\n    const date = new Date();\n    date.setTime(date.getTime() + (options.days * 24 * 60 * 60 * 1000));\n    cookieString = `${cookieString}; expires=${date.toGMTString()}`;\n  }\n  if (window.location.protocol === 'https:') {\n    cookieString += '; Secure';\n  }\n  document.cookie = cookieString;\n\n  return cookieString;\n};\n\nexport const getCookie = (name) => {\n  const nameEQ = `${name}=`;\n  const cookies = document.cookie.split(';');\n  for (let i = 0, len = cookies.length; i < len; i += 1) {\n    let cookie = cookies[i];\n    while (cookie.charAt(0) === ' ') {\n      cookie = cookie.substring(1, cookie.length);\n    }\n    if (cookie.indexOf(nameEQ) === 0) {\n      return decodeURIComponent(cookie.substring(nameEQ.length));\n    }\n  }\n  return null;\n};\n","export default class SessionActivityService {\n  constructor(BrowserBroadcastChannel) {\n    this.activityChannel = BrowserBroadcastChannel && new BrowserBroadcastChannel('session-activity');\n  }\n\n  logActivity() {\n    if (this.activityChannel) {\n      const event = { timestamp: Date.now() };\n      this.activityChannel.postMessage(event);\n    }\n  }\n\n  onActivity(callback) {\n    if (this.activityChannel) {\n      this.activityChannel.onmessage = (event) => {\n        callback(event.data);\n      };\n    }\n  }\n}\n","function HmrcPrintLink($module, window) {\n  this.$module = $module;\n  this.window = window;\n}\n\nHmrcPrintLink.prototype.init = function init() {\n  this.$module.addEventListener('click', (event) => {\n    event.preventDefault();\n    this.window.print();\n  });\n};\n\nexport default HmrcPrintLink;\n","import AccountMenu from './components/account-menu/account-menu';\nimport BackLinkHelper from './components/back-link-helper/back-link-helper';\nimport TimeoutDialog from './components/timeout-dialog/timeout-dialog';\nimport UserResearchBanner from './components/user-research-banner/user-research-banner';\nimport SessionActivityService from './components/timeout-dialog/session-activity-service';\nimport HmrcPrintLink from './components/hmrc-print-link/hmrc-print-link';\n\nfunction initAll() {\n  const $AccountMenuSelector = '[data-module=\"hmrc-account-menu\"]';\n  if (document.querySelector($AccountMenuSelector)) {\n    new AccountMenu($AccountMenuSelector).init();\n  }\n\n  const $HmrcPrintLinks = document.querySelectorAll('a[data-module=\"hmrc-print-link\"]');\n  $HmrcPrintLinks.forEach(($HmrcPrintLink) => {\n    new HmrcPrintLink($HmrcPrintLink, window).init();\n  });\n\n  const sessionActivityService = new SessionActivityService(window.BroadcastChannel);\n  sessionActivityService.logActivity();\n\n  const $TimeoutDialog = document.querySelector('meta[name=\"hmrc-timeout-dialog\"]');\n  if ($TimeoutDialog) {\n    new TimeoutDialog($TimeoutDialog, sessionActivityService).init();\n  }\n\n  const $UserResearchBanner = document.querySelector('[data-module=\"hmrc-user-research-banner\"]');\n  if ($UserResearchBanner) {\n    new UserResearchBanner($UserResearchBanner).init();\n  }\n\n  const $BackLinks = document.querySelectorAll('[data-module=\"hmrc-back-link\"]');\n  $BackLinks.forEach(($BackLink) => {\n    new BackLinkHelper($BackLink, window, document).init();\n  });\n}\n\nexport default {\n  initAll,\n  AccountMenu,\n  TimeoutDialog,\n  UserResearchBanner,\n  BackLinkHelper,\n\n};\n","import { initAll } from 'govuk-frontend/dist/govuk/govuk-frontend.min';\nimport HMRCFrontend from './all';\n\ninitAll();\nHMRCFrontend.initAll();\n"]}